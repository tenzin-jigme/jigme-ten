## Check Covid Vaccination Table 20 rows

SELECT * 
FROM PortfolioProject.coviddeath
LIMIT 20;


## Check Covid Vaccination Table 20 rows

SELECT * 
FROM PortfolioProject.covidvaccination
LIMIT 20;


## Select Data that we are going to be using

SELECT location, date, total_cases, new_cases, total_deaths, population
FROM PortfolioProject.coviddeath
ORDER BY 1, 2;

## Looking at Total Cases vs Total Deaths
## Shows likelihood of dying if you contract COVID in your country

SELECT location, date, total_cases, total_deaths, (total_deaths/total_cases)*100 as DeathPercentage
FROM PortfolioProject.coviddeath
ORDER BY 1, 2;

## Looking at Total Cases vs Total Deaths for USA

SELECT location, date, total_cases, total_deaths, (total_deaths/total_cases)*100 as DeathPercentage
FROM PortfolioProject.coviddeath
WHERE location like '%states%';

## Looking at Total Cases vs Population
## Shows what percentage of population got COVID

SELECT location, date, population, total_cases, (total_cases/population)*100 as PercentPopulationInfected
FROM PortfolioProject.coviddeath
WHERE location like '%states%';

## Looking at Countries with Highest Infection Rate compared to Population

SELECT location, population, MAX(total_cases) as HighestInfectionCount, MAX((total_cases/population))*100 as PercentPopulationInfected
FROM PortfolioProject.coviddeath
GROUP BY location, population;

## Looking at Countries with Highest Infection Rate compared to Population
## Top 10 Countries with Highest Infection Rate compared to Population

SELECT location, population, MAX(total_cases) as HighestInfectionCount, MAX((total_cases/population))*100 as PercentPopulationInfected
FROM PortfolioProject.coviddeath
GROUP BY location, population
ORDER BY 4 DESC
LIMIT 10;

## Countries with the Highest Death Count per Population
## Changed datatype of total_deaths from varchar to bigint using cast

SELECT location, MAX(cast(total_deaths as unsigned)) as TotalDeathCount
FROM PortfolioProject.coviddeath
GROUP BY location;

## Output includes location with continent names

SELECT location, MAX(cast(total_deaths as unsigned)) as TotalDeathCount
FROM PortfolioProject.coviddeath
GROUP BY location
ORDER BY 2 DESC;

## Lets Breakdown by Continent

SELECT continent, MAX(cast(total_deaths as unsigned)) as TotalDeathCount
FROM PortfolioProject.coviddeath
GROUP BY continent;
